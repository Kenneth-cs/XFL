# å¹¸ç¦åŠ›å©šæ‹ç³»ç»Ÿ - å¿«é€Ÿå¯åŠ¨æŒ‡å—

## ğŸš€ ç¬¬ä¸€æ¬¡å¯åŠ¨é¡¹ç›®

### å‰ç½®è¦æ±‚

ç¡®ä¿æ‚¨çš„ç”µè„‘å·²å®‰è£…ï¼š
- âœ… Node.js 18.x æˆ–æ›´é«˜ç‰ˆæœ¬
- âœ… MySQL 8.0 æˆ–æ›´é«˜ç‰ˆæœ¬
- âœ… Redis 6.x æˆ–æ›´é«˜ç‰ˆæœ¬

æ£€æŸ¥ç‰ˆæœ¬ï¼š
```bash
node -v   # åº”æ˜¾ç¤º v18.x.x æˆ–æ›´é«˜
mysql --version
redis-server --version
```

---

## ğŸ“ å¯åŠ¨æ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šå¯åŠ¨MySQLå’ŒRedisæœåŠ¡

#### macOSï¼ˆä½¿ç”¨Homebrewï¼‰
```bash
# å¯åŠ¨MySQL
brew services start mysql

# å¯åŠ¨Redis
brew services start redis
```

#### æˆ–è€…æ‰‹åŠ¨å¯åŠ¨
```bash
# MySQLï¼ˆå¦‚æœå·²å®‰è£…åœ¨ç³»ç»Ÿï¼‰
sudo mysql.server start

# Redis
redis-server
```

### ç¬¬äºŒæ­¥ï¼šåˆå§‹åŒ–æ•°æ®åº“

```bash
# è¿›å…¥æ•°æ®åº“ç›®å½•
cd "/Users/cs/Desktop/CS/åˆ›ä¸š/ç›¸äº²é¡¹ç›®å¼€å‘/å¹¸ç¦åŠ›é¡¹ç›®å¼€å‘/database"

# ç™»å½•MySQLï¼ˆè¾“å…¥rootå¯†ç ï¼‰
mysql -u root -p

# åœ¨MySQLå‘½ä»¤è¡Œä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
source 01_create_database.sql
source 02_create_tables.sql
source 03_init_data.sql

# é€€å‡ºMySQL
exit
```

æˆ–è€…ä¸€è¡Œå‘½ä»¤ï¼š
```bash
cd "/Users/cs/Desktop/CS/åˆ›ä¸š/ç›¸äº²é¡¹ç›®å¼€å‘/å¹¸ç¦åŠ›é¡¹ç›®å¼€å‘/database"
mysql -u root -p < 01_create_database.sql
mysql -u root -p < 02_create_tables.sql
mysql -u root -p < 03_init_data.sql
```

### ç¬¬ä¸‰æ­¥ï¼šé…ç½®å¹¶å¯åŠ¨åç«¯æœåŠ¡

```bash
# è¿›å…¥åç«¯ç›®å½•
cd "/Users/cs/Desktop/CS/åˆ›ä¸š/ç›¸äº²é¡¹ç›®å¼€å‘/å¹¸ç¦åŠ›é¡¹ç›®å¼€å‘/backend"

# å®‰è£…ä¾èµ–
npm install

# åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶
cat > .env << 'EOF'
# åº”ç”¨é…ç½®
NODE_ENV=development
PORT=3000
API_PREFIX=api/v1

# æ•°æ®åº“é…ç½®
DB_HOST=localhost
DB_PORT=3306
DB_USERNAME=root
DB_PASSWORD=ä½ çš„MySQLå¯†ç 
DB_DATABASE=xingfuli

# Redisé…ç½®
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# JWTé…ç½®
JWT_SECRET=xingfuli-secret-key-for-development-2024
JWT_EXPIRES_IN=7d

# è…¾è®¯äº‘COSé…ç½®ï¼ˆæš‚æ—¶å¯ä»¥ç•™ç©ºï¼Œä¸å½±å“å…¶ä»–åŠŸèƒ½ï¼‰
COS_SECRET_ID=
COS_SECRET_KEY=
COS_BUCKET=
COS_REGION=ap-guangzhou
EOF

# ä¿®æ”¹.envæ–‡ä»¶ä¸­çš„MySQLå¯†ç 
nano .env  # æˆ–ä½¿ç”¨å…¶ä»–ç¼–è¾‘å™¨ä¿®æ”¹DB_PASSWORD

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run start:dev
```

**çœ‹åˆ°ä»¥ä¸‹ä¿¡æ¯è¡¨ç¤ºåç«¯å¯åŠ¨æˆåŠŸï¼š**
```
âœ… Redisè¿æ¥æˆåŠŸï¼ˆIDç”Ÿæˆå™¨ï¼‰
âœ… Redisè¿æ¥æˆåŠŸ
ğŸš€ Application is running on: http://localhost:3000/api/v1
```

### ç¬¬å››æ­¥ï¼šé…ç½®å¹¶å¯åŠ¨å‰ç«¯H5

**æ‰“å¼€æ–°çš„ç»ˆç«¯çª—å£**ï¼Œæ‰§è¡Œï¼š

```bash
# è¿›å…¥å‰ç«¯ç›®å½•
cd "/Users/cs/Desktop/CS/åˆ›ä¸š/ç›¸äº²é¡¹ç›®å¼€å‘/å¹¸ç¦åŠ›é¡¹ç›®å¼€å‘/frontend-h5"

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

**çœ‹åˆ°ä»¥ä¸‹ä¿¡æ¯è¡¨ç¤ºå‰ç«¯å¯åŠ¨æˆåŠŸï¼š**
```
VITE v5.x.x  ready in xxx ms

âœ  Local:   http://localhost:5174/
```

---

## âœ… éªŒæ”¶æµ‹è¯•æ¸…å•

### 1. æµ‹è¯•åç«¯å¥åº·æ£€æŸ¥

åœ¨æµè§ˆå™¨è®¿é—®ï¼š
```
http://localhost:3000/api/v1/health
```

**é¢„æœŸç»“æœ**ï¼š
```json
{
  "status": "ok",
  "timestamp": "2026-01-11T...",
  "service": "å¹¸ç¦åŠ›å©šæ‹ç³»ç»Ÿ"
}
```

### 2. æµ‹è¯•å‰å°H5é¡µé¢

åœ¨æµè§ˆå™¨è®¿é—®ï¼š
```
http://localhost:5174/
```

**é¢„æœŸçœ‹åˆ°**ï¼š
- ç´«è‰²æ¸å˜çš„é¦–é¡µ
- "å¹¸ç¦åŠ›å©šæ‹ç³»ç»Ÿ"æ ‡é¢˜
- ç³»ç»Ÿä»‹ç»
- "è¿›å…¥ä¸ªäººä¸­å¿ƒ"æŒ‰é’®

### 3. æµ‹è¯•ç”¨æˆ·æ³¨å†Œæµç¨‹

#### 3.1 ç‚¹å‡»"è¿›å…¥ä¸ªäººä¸­å¿ƒ" â†’ è‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µ

#### 3.2 ç‚¹å‡»"è¿˜æ²¡æœ‰è´¦å·ï¼Ÿç«‹å³æ³¨å†Œ"

#### 3.3 å¡«å†™æ³¨å†Œè¡¨å•
- æ‰‹æœºå·ï¼š13800138000
- å¯†ç ï¼š123456
- å§“åï¼šæµ‹è¯•ç”¨æˆ·
- æ€§åˆ«ï¼šç”·
- å‡ºç”Ÿæ—¥æœŸï¼š1990-01-01
- èº«é«˜ï¼š175
- ä½“é‡ï¼š70
- å­¦å†ï¼šæœ¬ç§‘
- å©šå†µï¼šæœªå©š
- æ°‘æ—ï¼šæ±‰æ—
- å½’å±é—¨åº—ï¼šæ€»éƒ¨æµ‹è¯•é—¨åº—ï¼ˆXFL001ï¼‰

#### 3.4 ç‚¹å‡»"æ³¨å†Œ"

**é¢„æœŸç»“æœ**ï¼š
- æ˜¾ç¤º"æ³¨å†ŒæˆåŠŸï¼Œè¯·ç™»å½•"æç¤º
- è‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µ

### 4. æµ‹è¯•ç”¨æˆ·ç™»å½•

#### 4.1 è¾“å…¥åˆšæ³¨å†Œçš„è´¦å·
- æ‰‹æœºå·ï¼š13800138000
- å¯†ç ï¼š123456

#### 4.2 ç‚¹å‡»"ç™»å½•"

**é¢„æœŸç»“æœ**ï¼š
- æ˜¾ç¤º"ç™»å½•æˆåŠŸ"æç¤º
- è‡ªåŠ¨è·³è½¬åˆ°é¦–é¡µ

### 5. æµ‹è¯•ä¸ªäººä¸­å¿ƒ

#### 5.1 ç‚¹å‡»"è¿›å…¥ä¸ªäººä¸­å¿ƒ"

**é¢„æœŸçœ‹åˆ°**ï¼š
- ç”¨æˆ·IDï¼ˆæ ¼å¼ï¼šXFL00100030ï¼‰
- æ‰‹æœºå·ï¼š13800138000
- å½’å±é—¨åº—ï¼šXFL001
- æ¡£æ¡ˆä¿¡æ¯ï¼ˆå§“åã€æ€§åˆ«ã€èº«é«˜ç­‰ï¼‰
- æµ‹è¯„è®°å½•ï¼ˆæ˜¾ç¤º"å¾…å®Œæˆ"ï¼‰

#### 5.2 ç‚¹å‡»"é€€å‡ºç™»å½•"

**é¢„æœŸç»“æœ**ï¼š
- å¼¹å‡ºç¡®è®¤å¯¹è¯æ¡†
- ç¡®è®¤åè·³è½¬åˆ°ç™»å½•é¡µ

---

## ğŸ§ª æµ‹è¯•åå°ç®¡ç†åŠŸèƒ½ï¼ˆä½¿ç”¨APIå·¥å…·ï¼‰

### å‡†å¤‡å·¥å…·
æ¨èä½¿ç”¨ï¼š
- Postman
- Apifox
- æˆ–è€…å‘½ä»¤è¡Œ curl

### 1. ç”Ÿæˆè¶…çº§ç®¡ç†å‘˜å¯†ç 

```bash
# åœ¨åç«¯ç›®å½•æ‰§è¡Œ
cd "/Users/cs/Desktop/CS/åˆ›ä¸š/ç›¸äº²é¡¹ç›®å¼€å‘/å¹¸ç¦åŠ›é¡¹ç›®å¼€å‘/backend"

# ç”Ÿæˆå¯†ç å“ˆå¸Œ
node -e "const bcrypt = require('bcrypt'); bcrypt.hash('admin123', 10).then(hash => console.log(hash))"
```

**å¤åˆ¶è¾“å‡ºçš„å“ˆå¸Œå€¼**ï¼Œç„¶åæ›´æ–°æ•°æ®åº“ï¼š

```bash
mysql -u root -p xingfuli

# åœ¨MySQLä¸­æ‰§è¡Œï¼ˆæ›¿æ¢æˆä½ ç”Ÿæˆçš„å“ˆå¸Œå€¼ï¼‰
UPDATE sys_user SET password='$2b$10$ç”Ÿæˆçš„å“ˆå¸Œå€¼' WHERE id='SUPER_ADMIN';
exit
```

### 2. æµ‹è¯•è¶…çº§ç®¡ç†å‘˜ç™»å½•

```bash
curl -X POST http://localhost:3000/api/v1/auth/login/sys \
  -H "Content-Type: application/json" \
  -d '{
    "username": "admin",
    "password": "admin123"
  }'
```

**é¢„æœŸè¿”å›**ï¼š
```json
{
  "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": {
    "id": "SUPER_ADMIN",
    "username": "admin",
    "role": "super_admin",
    "storeId": "XFL001"
  }
}
```

**å¤åˆ¶accessToken**ï¼Œç”¨äºåç»­è¯·æ±‚ã€‚

### 3. æµ‹è¯•åˆ›å»ºé—¨åº—

```bash
curl -X POST http://localhost:3000/api/v1/stores \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer ä½ çš„accessToken" \
  -d '{
    "name": "æ·±åœ³é—¨åº—",
    "mvTemplateId": 1,
    "contactPerson": "å¼ ç»ç†",
    "contactPhone": "13800138001"
  }'
```

**é¢„æœŸè¿”å›**ï¼šæ–°åˆ›å»ºçš„é—¨åº—ä¿¡æ¯ï¼ŒåŒ…å«è‡ªåŠ¨ç”Ÿæˆçš„IDï¼ˆå¦‚XFL002ï¼‰

### 4. æµ‹è¯•è·å–é—¨åº—åˆ—è¡¨

```bash
curl -X GET http://localhost:3000/api/v1/stores \
  -H "Authorization: Bearer ä½ çš„accessToken"
```

**é¢„æœŸè¿”å›**ï¼šé—¨åº—åˆ—è¡¨æ•°ç»„

### 5. æµ‹è¯•åˆ›å»ºåå°ç”¨æˆ·ï¼ˆçº¢å¨˜ï¼‰

```bash
curl -X POST http://localhost:3000/api/v1/users/sys \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer ä½ çš„accessToken" \
  -d '{
    "username": "çº¢å¨˜01",
    "storeId": "XFL001",
    "role": "matchmaker",
    "phone": "13900139000",
    "password": "123456"
  }'
```

**é¢„æœŸè¿”å›**ï¼šæ–°åˆ›å»ºçš„ç”¨æˆ·ä¿¡æ¯ï¼ŒåŒ…å«è‡ªåŠ¨ç”Ÿæˆçš„IDï¼ˆå¦‚XFL001G13702ï¼‰

### 6. æµ‹è¯•è·å–å‰å°ç”¨æˆ·åˆ—è¡¨

```bash
curl -X GET http://localhost:3000/api/v1/users/app \
  -H "Authorization: Bearer ä½ çš„accessToken"
```

**é¢„æœŸè¿”å›**ï¼šå‰å°ç”¨æˆ·åˆ—è¡¨ï¼ˆåŒ…å«åˆšæ³¨å†Œçš„æµ‹è¯•ç”¨æˆ·ï¼‰

---

## ğŸ¯ éªŒæ”¶æ£€æŸ¥ç‚¹

### åŸºç¡€åŠŸèƒ½ âœ…
- [ ] åç«¯æœåŠ¡å¯åŠ¨æˆåŠŸ
- [ ] å‰ç«¯H5å¯åŠ¨æˆåŠŸ
- [ ] æ•°æ®åº“è¿æ¥æ­£å¸¸
- [ ] Redisè¿æ¥æ­£å¸¸

### å‰å°ç”¨æˆ·åŠŸèƒ½ âœ…
- [ ] ç”¨æˆ·æ³¨å†ŒæˆåŠŸ
- [ ] ç”¨æˆ·ç™»å½•æˆåŠŸ
- [ ] è‡ªåŠ¨ç”Ÿæˆç”¨æˆ·IDï¼ˆæ ¼å¼æ­£ç¡®ï¼‰
- [ ] ä¸ªäººä¸­å¿ƒæ˜¾ç¤ºæ­£å¸¸
- [ ] æ¡£æ¡ˆä¿¡æ¯å®Œæ•´
- [ ] é€€å‡ºç™»å½•æ­£å¸¸

### åå°ç®¡ç†åŠŸèƒ½ âœ…
- [ ] è¶…çº§ç®¡ç†å‘˜ç™»å½•æˆåŠŸ
- [ ] JWT Tokenç”Ÿæˆæ­£å¸¸
- [ ] åˆ›å»ºé—¨åº—æˆåŠŸ
- [ ] è‡ªåŠ¨ç”Ÿæˆé—¨åº—IDï¼ˆæ ¼å¼æ­£ç¡®ï¼‰
- [ ] é—¨åº—åˆ—è¡¨æŸ¥è¯¢æˆåŠŸ
- [ ] åˆ›å»ºåå°ç”¨æˆ·æˆåŠŸ
- [ ] è‡ªåŠ¨ç”Ÿæˆåå°ç”¨æˆ·IDï¼ˆæ ¼å¼æ­£ç¡®ï¼‰
- [ ] å‰å°ç”¨æˆ·åˆ—è¡¨æŸ¥è¯¢æˆåŠŸ

### å®‰å…¨åŠŸèƒ½ âœ…
- [ ] æœªç™»å½•è®¿é—®ä¸ªäººä¸­å¿ƒè‡ªåŠ¨è·³è½¬ç™»å½•é¡µ
- [ ] Tokenè¿‡æœŸåæ— æ³•è®¿é—®å—ä¿æŠ¤æ¥å£
- [ ] å¯†ç åŠ å¯†å­˜å‚¨ï¼ˆæ•°æ®åº“ä¸­çœ‹ä¸åˆ°æ˜æ–‡ï¼‰

---

## ğŸ› å¸¸è§é—®é¢˜è§£å†³

### 1. åç«¯å¯åŠ¨æŠ¥é”™ï¼šæ— æ³•è¿æ¥MySQL

**é—®é¢˜**ï¼š`Error: connect ECONNREFUSED 127.0.0.1:3306`

**è§£å†³**ï¼š
```bash
# æ£€æŸ¥MySQLæ˜¯å¦è¿è¡Œ
mysql.server status

# å¦‚æœæœªè¿è¡Œï¼Œå¯åŠ¨MySQL
brew services start mysql
# æˆ–
sudo mysql.server start
```

### 2. åç«¯å¯åŠ¨æŠ¥é”™ï¼šæ— æ³•è¿æ¥Redis

**é—®é¢˜**ï¼š`Error: connect ECONNREFUSED 127.0.0.1:6379`

**è§£å†³**ï¼š
```bash
# å¯åŠ¨Redis
redis-server
# æˆ–åå°è¿è¡Œ
brew services start redis
```

### 3. å‰ç«¯å¯åŠ¨æŠ¥é”™ï¼šç«¯å£è¢«å ç”¨

**é—®é¢˜**ï¼š`Port 5174 is in use`

**è§£å†³**ï¼š
```bash
# æ–¹æ³•1ï¼šå…³é—­å ç”¨ç«¯å£çš„è¿›ç¨‹
lsof -ti:5174 | xargs kill -9

# æ–¹æ³•2ï¼šä¿®æ”¹vite.config.tsä¸­çš„ç«¯å£ä¸ºå…¶ä»–å€¼ï¼ˆå¦‚5175ï¼‰
```

### 4. æ³¨å†Œæ—¶æç¤º"é—¨åº—ä¸å­˜åœ¨"

**é—®é¢˜**ï¼šæ•°æ®åº“åˆå§‹åŒ–è„šæœ¬æœªæ‰§è¡Œ

**è§£å†³**ï¼š
```bash
cd "/Users/cs/Desktop/CS/åˆ›ä¸š/ç›¸äº²é¡¹ç›®å¼€å‘/å¹¸ç¦åŠ›é¡¹ç›®å¼€å‘/database"
mysql -u root -p xingfuli < 03_init_data.sql
```

### 5. è¶…çº§ç®¡ç†å‘˜æ— æ³•ç™»å½•

**é—®é¢˜**ï¼šå¯†ç å“ˆå¸Œæœªè®¾ç½®

**è§£å†³**ï¼šæŒ‰ç…§ä¸Šé¢"æµ‹è¯•åå°ç®¡ç†åŠŸèƒ½"ä¸­çš„æ­¥éª¤ç”Ÿæˆå¹¶æ›´æ–°å¯†ç å“ˆå¸Œ

### 6. å›¾ç‰‡ä¸Šä¼ å¤±è´¥

**é—®é¢˜**ï¼šCOSé…ç½®æœªå¡«å†™

**è¯´æ˜**ï¼šå›¾ç‰‡ä¸Šä¼ åŠŸèƒ½éœ€è¦è…¾è®¯äº‘COSé…ç½®ï¼Œå¯ä»¥æš‚æ—¶è·³è¿‡æ­¤åŠŸèƒ½æµ‹è¯•ã€‚å¦‚éœ€æµ‹è¯•ï¼š
1. æ³¨å†Œè…¾è®¯äº‘è´¦å·
2. å¼€é€šCOSæœåŠ¡
3. åˆ›å»ºå­˜å‚¨æ¡¶
4. è·å–SecretIdå’ŒSecretKey
5. å¡«å†™åˆ°`.env`æ–‡ä»¶ä¸­

---

## ğŸ“± æ¨èçš„æµ‹è¯•è®¾å¤‡

### å‰å°H5æµ‹è¯•
1. **ç”µè„‘æµè§ˆå™¨**ï¼ˆå¼€å‘è€…å·¥å…·åˆ‡æ¢åˆ°ç§»åŠ¨è®¾å¤‡æ¨¡å¼ï¼‰
   - Chrome DevTools (F12) â†’ Toggle device toolbar (Ctrl+Shift+M)
   - é€‰æ‹©iPhoneæˆ–Androidè®¾å¤‡

2. **çœŸå®æ‰‹æœºæµè§ˆå™¨**
   - ç”µè„‘å’Œæ‰‹æœºåœ¨åŒä¸€WiFiä¸‹
   - è®¿é—®ï¼š`http://ä½ çš„ç”µè„‘IP:5174`
   - è·å–IPï¼š`ifconfig | grep inet`

### åå°ç®¡ç†æµ‹è¯•
ä½¿ç”¨APIå·¥å…·ï¼ˆPostmanã€Apifoxç­‰ï¼‰

---

## ğŸ‰ éªŒæ”¶é€šè¿‡æ ‡å‡†

å½“ä»¥ä¸‹æ‰€æœ‰åŠŸèƒ½éƒ½èƒ½æ­£å¸¸å·¥ä½œæ—¶ï¼Œè¡¨ç¤ºç¬¬ä¸€é˜¶æ®µå¼€å‘éªŒæ”¶é€šè¿‡ï¼š

âœ… **ç”¨æˆ·ç³»ç»Ÿ**
- å‰å°ç”¨æˆ·æ³¨å†Œã€ç™»å½•
- åå°ç”¨æˆ·åˆ›å»ºã€å®¡æ ¸
- IDè‡ªåŠ¨ç”Ÿæˆä¸”æ ¼å¼æ­£ç¡®

âœ… **æƒé™ç³»ç»Ÿ**
- JWTè®¤è¯æ­£å¸¸
- è§’è‰²æƒé™æ§åˆ¶æœ‰æ•ˆ
- é—¨åº—æ•°æ®éš”ç¦»æ­£å¸¸

âœ… **æ•°æ®ç®¡ç†**
- é—¨åº—CRUDæ“ä½œæ­£å¸¸
- ç”¨æˆ·æ¡£æ¡ˆæŸ¥çœ‹ç¼–è¾‘æ­£å¸¸
- æ•°æ®åº“äº‹åŠ¡æ­£å¸¸

âœ… **ç•Œé¢ä½“éªŒ**
- H5é¡µé¢æ˜¾ç¤ºæ­£å¸¸
- è¡¨å•éªŒè¯æœ‰æ•ˆ
- äº¤äº’æµç•…

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°é—®é¢˜ï¼š
1. æŸ¥çœ‹ç»ˆç«¯çš„é”™è¯¯ä¿¡æ¯
2. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰
3. æ£€æŸ¥æ•°æ®åº“å’ŒRedisæ˜¯å¦æ­£å¸¸è¿è¡Œ
4. å‚è€ƒæœ¬æ–‡æ¡£çš„"å¸¸è§é—®é¢˜è§£å†³"éƒ¨åˆ†

ç¥æ‚¨æµ‹è¯•é¡ºåˆ©ï¼ğŸš€

