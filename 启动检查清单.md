# 启动检查清单 ✅

## ⚠️ 启动前必须完成的事项

### 1. 检查MySQL和Redis是否运行
```bash
# 检查MySQL
mysql.server status
# 或
brew services list | grep mysql

# 检查Redis
redis-cli ping
# 应该返回 PONG
```

**如果未运行，请启动：**
```bash
# 启动MySQL
brew services start mysql
# 或
sudo mysql.server start

# 启动Redis
brew services start redis
# 或在新终端运行
redis-server
```

---

## 🚀 启动步骤

### 步骤1：启动后端（终端1）

```bash
cd "/Users/cs/Desktop/CS/创业/相亲项目开发/幸福力项目开发/backend"

# 如果是首次启动，需要先配置.env文件
# 复制示例文件
cp .env.example .env

# 编辑.env，至少修改这些配置：
# DB_PASSWORD=你的MySQL密码
# 其他配置可以保持默认

# 启动开发服务器
npm run start:dev
```

**✅ 后端启动成功的标志：**
```
✅ Redis连接成功（ID生成器）
✅ Redis连接成功
🚀 Application is running on: http://localhost:3000/api/v1
```

**后端API地址：**
- 健康检查：http://localhost:3000/api/v1/health
- API基础地址：http://localhost:3000/api/v1

---

### 步骤2：启动前端（终端2 - 新终端窗口）

```bash
cd "/Users/cs/Desktop/CS/创业/相亲项目开发/幸福力项目开发/frontend-h5"

# 启动开发服务器
npm run dev
```

**✅ 前端启动成功的标志：**
```
VITE v5.x.x  ready in xxx ms

➜  Local:   http://localhost:5174/
➜  Network: use --host to expose
```

**前端访问地址：**
- 在浏览器打开：http://localhost:5174

---

## 🧪 快速验证

### 1. 验证后端是否正常
在浏览器访问：
```
http://localhost:3000/api/v1/health
```

**预期返回：**
```json
{
  "status": "ok",
  "timestamp": "2026-01-11T...",
  "service": "幸福力婚恋系统"
}
```

### 2. 验证前端是否正常
在浏览器访问：
```
http://localhost:5174
```

**预期看到：**
- 紫色渐变背景的首页
- "幸福力婚恋系统"标题
- "科学匹配，幸福相遇"副标题
- "进入个人中心"按钮

### 3. 验证前后端通信
在前端页面：
1. 点击"进入个人中心"
2. 自动跳转到登录页
3. 点击"还没有账号？立即注册"
4. 看到完整的注册表单

---

## ❌ 常见启动错误及解决方案

### 错误1：后端 - 无法连接MySQL
```
Error: connect ECONNREFUSED 127.0.0.1:3306
```

**解决方案：**
```bash
# 启动MySQL
brew services start mysql
# 或
sudo mysql.server start
```

### 错误2：后端 - 无法连接Redis
```
Error: connect ECONNREFUSED 127.0.0.1:6379
```

**解决方案：**
```bash
# 启动Redis
brew services start redis
# 或在新终端
redis-server
```

### 错误3：后端 - Access denied for user
```
Error: Access denied for user 'root'@'localhost'
```

**解决方案：**
检查 `.env` 文件中的 `DB_PASSWORD` 是否正确。

### 错误4：前端 - Cannot GET /
浏览器显示空白或错误

**解决方案：**
1. 检查终端是否有编译错误
2. 清除缓存重启：
```bash
# Ctrl+C 停止前端
# 删除缓存
rm -rf node_modules/.vite
# 重新启动
npm run dev
```

### 错误5：端口被占用
```
Error: Port 5174 is already in use
```

**解决方案：**
```bash
# 查找并关闭占用端口的进程
lsof -ti:5174 | xargs kill -9

# 或修改vite.config.ts中的端口
```

---

## 📊 完整启动检查表

启动前检查：
- [ ] MySQL 正在运行
- [ ] Redis 正在运行
- [ ] 已配置 backend/.env 文件
- [ ] 已安装后端依赖（npm install）
- [ ] 已安装前端依赖（npm install）

启动后验证：
- [ ] 后端启动成功（看到✅标志）
- [ ] 前端启动成功（看到Local地址）
- [ ] 健康检查接口返回正常
- [ ] 前端首页显示正常
- [ ] 可以访问注册页面

---

## 🎯 下一步：初始化数据库

如果这是**首次启动**，还需要初始化数据库：

```bash
# 进入数据库目录
cd "/Users/cs/Desktop/CS/创业/相亲项目开发/幸福力项目开发/database"

# 执行初始化脚本
mysql -u root -p < 01_create_database.sql
mysql -u root -p < 02_create_tables.sql
mysql -u root -p < 03_init_data.sql
```

初始化后，需要设置超级管理员密码：
```bash
cd "/Users/cs/Desktop/CS/创业/相亲项目开发/幸福力项目开发/backend"

# 生成密码哈希（密码：admin123）
node -e "const bcrypt = require('bcrypt'); bcrypt.hash('admin123', 10).then(hash => console.log(hash))"

# 复制输出的哈希值，然后更新数据库
mysql -u root -p xingfuli

# 在MySQL中执行（替换成你生成的哈希值）
UPDATE sys_user SET password='$2b$10$你生成的哈希值' WHERE id='SUPER_ADMIN';
exit
```

---

## 🎉 全部正常？

如果上述所有检查都通过，恭喜！您可以开始使用系统了：

1. **前台用户注册**：http://localhost:5174/register
2. **前台用户登录**：http://localhost:5174/login
3. **个人中心**：http://localhost:5174/profile

**使用API工具测试后台管理功能**（Postman、Apifox等）：
- 后台登录：POST http://localhost:3000/api/v1/auth/login/sys
- 查看门店：GET http://localhost:3000/api/v1/stores

详细的测试步骤请参考：`快速启动指南.md`

---

**遇到问题？** 
请检查终端的错误信息，大部分问题都是因为：
1. MySQL或Redis未启动
2. .env配置不正确
3. 数据库未初始化

