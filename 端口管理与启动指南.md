# ç«¯å£ç®¡ç†ä¸å¯åŠ¨æŒ‡å—

## ğŸ“Œ é¡¹ç›®ç«¯å£é…ç½®

| æœåŠ¡ | ç«¯å£ | è¯´æ˜ |
|------|------|------|
| åç«¯API | 3000 | NestJSåç«¯æœåŠ¡ |
| å‰å°H5 | 5173 | Viteå¼€å‘æœåŠ¡å™¨ (Vue 3) |
| åå°ç®¡ç† | 5175 | Viteå¼€å‘æœåŠ¡å™¨ (Vue 3 + Ant Design) |

---

## ğŸ” æŸ¥çœ‹ç«¯å£å ç”¨

### æ–¹æ³•1: ä½¿ç”¨è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
# æ£€æŸ¥æ‰€æœ‰é¡¹ç›®ç«¯å£
./scripts/port-check.sh check

# åªæ£€æŸ¥åç«¯
./scripts/port-check.sh backend

# åªæ£€æŸ¥å‰ç«¯
./scripts/port-check.sh frontend
```

### æ–¹æ³•2: æ‰‹åŠ¨å‘½ä»¤

```bash
# æŸ¥çœ‹ç‰¹å®šç«¯å£
lsof -i :3000
lsof -i :5173
lsof -i :5175

# æŸ¥çœ‹æ‰€æœ‰ç›‘å¬ç«¯å£
lsof -i -P | grep LISTEN

# æŸ¥çœ‹æ‰€æœ‰Nodeè¿›ç¨‹
ps aux | grep node
```

---

## ğŸ§¹ æ¸…ç†ç«¯å£å ç”¨

### æ–¹æ³•1: ä½¿ç”¨è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
# æ¸…ç†æ‰€æœ‰é¡¹ç›®ç«¯å£
./scripts/port-check.sh kill

# æ¸…ç†æŒ‡å®šç«¯å£
./scripts/port-check.sh kill 3000
```

### æ–¹æ³•2: æ‰‹åŠ¨å‘½ä»¤

```bash
# æ¸…ç†ç‰¹å®šç«¯å£
lsof -ti:3000 | xargs kill -9

# æ¸…ç†æ‰€æœ‰nestè¿›ç¨‹
pkill -f "nest start"

# æ¸…ç†æ‰€æœ‰viteè¿›ç¨‹
pkill -f "vite"

# ç»„åˆæ¸…ç†ï¼ˆæ¨èï¼‰
lsof -ti:3000 | xargs kill -9 && pkill -f "nest start"
```

---

## ğŸš€ å¯åŠ¨é¡¹ç›®

### æ–¹æ³•1: ä¸€é”®å¯åŠ¨ï¼ˆæ¨èï¼‰

```bash
# è‡ªåŠ¨æ£€æŸ¥ç«¯å£ã€æ¸…ç†å†²çªã€å¯åŠ¨æ‰€æœ‰æœåŠ¡
./scripts/start-all.sh
```

### æ–¹æ³•2: æ‰‹åŠ¨åˆ†æ­¥å¯åŠ¨

```bash
# 1. å…ˆæ¸…ç†ç«¯å£
./scripts/port-check.sh kill

# 2. å¯åŠ¨åç«¯ï¼ˆåå°è¿è¡Œï¼‰
cd backend && npm run start:dev &

# 3. å¯åŠ¨å‰å°H5ï¼ˆåå°è¿è¡Œï¼‰
cd frontend-h5 && npm run dev &

# 4. å¯åŠ¨åå°ç®¡ç†ï¼ˆåå°è¿è¡Œï¼‰
cd frontend-admin && npm run dev &

# 5. æ£€æŸ¥å¯åŠ¨çŠ¶æ€
./scripts/port-check.sh check
```

---

## âš ï¸ å¸¸è§é—®é¢˜

### é—®é¢˜1: ç«¯å£è¢«å ç”¨

**ç—‡çŠ¶**: å¯åŠ¨æ—¶æŠ¥é”™ `Error: listen EADDRINUSE: address already in use :::3000`

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ–¹æ¡ˆA: ä½¿ç”¨è„šæœ¬æ¸…ç†
./scripts/port-check.sh kill

# æ–¹æ¡ˆB: æ‰‹åŠ¨æ¸…ç†
lsof -ti:3000 | xargs kill -9
```

---

### é—®é¢˜2: å¤šä¸ªè¿›ç¨‹æ®‹ç•™

**ç—‡çŠ¶**: `ps aux | grep node` æ˜¾ç¤ºå¤šä¸ªnestæˆ–viteè¿›ç¨‹

**è§£å†³æ–¹æ¡ˆ**:
```bash
# å½»åº•æ¸…ç†æ‰€æœ‰ç›¸å…³è¿›ç¨‹
pkill -f "nest start"
pkill -f "vite"
./scripts/port-check.sh kill
```

---

### é—®é¢˜3: ç«¯å£æ¸…ç†åä»ç„¶æ— æ³•å¯åŠ¨

**ç—‡çŠ¶**: æ¸…ç†ç«¯å£åç«‹å³å¯åŠ¨ä»æŠ¥é”™

**è§£å†³æ–¹æ¡ˆ**:
```bash
# ç­‰å¾…2-3ç§’è®©ç³»ç»Ÿé‡Šæ”¾ç«¯å£
./scripts/port-check.sh kill
sleep 3
npm run start:dev
```

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. å¼€å‘å‰æ£€æŸ¥

æ¯æ¬¡å¼€å‘å‰å…ˆæ£€æŸ¥ç«¯å£çŠ¶æ€ï¼š
```bash
./scripts/port-check.sh check
```

### 2. å¼€å‘ç»“æŸåæ¸…ç†

é€€å‡ºå¼€å‘æ—¶åŠæ—¶æ¸…ç†ï¼š
```bash
./scripts/port-check.sh kill
```

### 3. ä½¿ç”¨å¿«æ·å‘½ä»¤

åœ¨ `~/.zshrc` æˆ– `~/.bashrc` ä¸­æ·»åŠ åˆ«åï¼š
```bash
# æ·»åŠ ä»¥ä¸‹å†…å®¹åˆ°é…ç½®æ–‡ä»¶
alias xfl-check='cd ~/Desktop/CS/åˆ›ä¸š/ç›¸äº²é¡¹ç›®å¼€å‘/å¹¸ç¦åŠ›é¡¹ç›®å¼€å‘ && ./scripts/port-check.sh check'
alias xfl-kill='cd ~/Desktop/CS/åˆ›ä¸š/ç›¸äº²é¡¹ç›®å¼€å‘/å¹¸ç¦åŠ›é¡¹ç›®å¼€å‘ && ./scripts/port-check.sh kill'
alias xfl-start='cd ~/Desktop/CS/åˆ›ä¸š/ç›¸äº²é¡¹ç›®å¼€å‘/å¹¸ç¦åŠ›é¡¹ç›®å¼€å‘ && ./scripts/start-all.sh'

# ä½¿é…ç½®ç”Ÿæ•ˆ
source ~/.zshrc
```

ä¹‹åå°±å¯ä»¥åœ¨ä»»æ„ç›®å½•ä½¿ç”¨ï¼š
```bash
xfl-check   # æ£€æŸ¥ç«¯å£
xfl-kill    # æ¸…ç†ç«¯å£
xfl-start   # å¯åŠ¨é¡¹ç›®
```

---

## ğŸ› ï¸ è„šæœ¬è¯´æ˜

### `port-check.sh`

ç«¯å£ç®¡ç†è„šæœ¬ï¼Œæ”¯æŒä»¥ä¸‹åŠŸèƒ½ï¼š
- âœ… æ£€æŸ¥å•ä¸ªæˆ–æ‰€æœ‰ç«¯å£çŠ¶æ€
- âœ… æ˜¾ç¤ºå ç”¨è¿›ç¨‹çš„è¯¦ç»†ä¿¡æ¯
- âœ… ä¸€é”®æ¸…ç†æŒ‡å®šæˆ–æ‰€æœ‰ç«¯å£
- âœ… å½©è‰²è¾“å‡ºï¼Œæ¸…æ™°æ˜“è¯»

### `start-all.sh`

ä¸€é”®å¯åŠ¨è„šæœ¬ï¼Œè‡ªåŠ¨æ‰§è¡Œï¼š
1. æ£€æŸ¥ç«¯å£å ç”¨æƒ…å†µ
2. æç¤ºæ˜¯å¦æ¸…ç†å†²çªç«¯å£
3. ä¾æ¬¡å¯åŠ¨åç«¯ã€å‰å°H5ã€åå°ç®¡ç†
4. éªŒè¯å¯åŠ¨çŠ¶æ€
5. æ˜¾ç¤ºè®¿é—®åœ°å€

---

## ğŸ“ æ—¥å¸¸å¼€å‘æµç¨‹

```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd ~/Desktop/CS/åˆ›ä¸š/ç›¸äº²é¡¹ç›®å¼€å‘/å¹¸ç¦åŠ›é¡¹ç›®å¼€å‘

# 2. æ£€æŸ¥ç«¯å£ï¼ˆå¯é€‰ï¼‰
./scripts/port-check.sh check

# 3. ä¸€é”®å¯åŠ¨
./scripts/start-all.sh

# 4. å¼€å‘ä¸­...

# 5. ç»“æŸå¼€å‘ï¼Œæ¸…ç†è¿›ç¨‹
./scripts/port-check.sh kill
```

---

## ğŸ”§ é«˜çº§æŠ€å·§

### æŸ¥çœ‹ç«¯å£å ç”¨è¯¦æƒ…

```bash
# æŸ¥çœ‹è¯¦ç»†çš„è¿›ç¨‹æ ‘
lsof -i :3000 | awk 'NR==1 || /LISTEN/'

# æŸ¥çœ‹è¿›ç¨‹å¯åŠ¨æ—¶é—´
ps -p $(lsof -ti:3000) -o pid,etime,cmd
```

### ç›‘æ§ç«¯å£çŠ¶æ€

```bash
# å®æ—¶ç›‘æ§ç«¯å£
watch -n 1 "lsof -i :3000,5173,5175"
```

### ä¸€é”®é‡å¯

```bash
# æ¸…ç† + å¯åŠ¨åç«¯
./scripts/port-check.sh kill 3000 && cd backend && npm run start:dev
```

